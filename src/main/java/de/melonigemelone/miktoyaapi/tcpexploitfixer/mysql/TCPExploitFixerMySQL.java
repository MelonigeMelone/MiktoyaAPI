package de.melonigemelone.miktoyaapi.tcpexploitfixer.mysql;

import de.melonigemelone.miktoyaapi.lib.database.mysql.Callback;
import de.melonigemelone.miktoyaapi.lib.database.mysql.MySQL;
import de.melonigemelone.miktoyaapi.mysql.MySQLValues;

public class TCPExploitFixerMySQL extends MySQL {


    public TCPExploitFixerMySQL() {
        super(MySQLValues.HOST.getValue(), MySQLValues.PORT.getValue(), MySQLValues.DATABASE.getValue(), MySQLValues.USER.getValue(), MySQLValues.PASSWORD.getValue());

        createTableIfNotExists("tcpexploitfixer_uuids",
                "  `id` int(11) unsigned NOT NULL AUTO_INCREMENT," +
                        "  `uuid` varchar(64) NOT NULL DEFAULT ''," +
                        "  PRIMARY KEY (`id`)"
        );

        createTableIfNotExists("tcpexploitfixer_connections",
                "  `id` int(11) unsigned NOT NULL AUTO_INCREMENT," +
                        "  `uuid` varchar(64) NOT NULL DEFAULT ''," +
                        "  PRIMARY KEY (`id`)"
        );

    }

    public void existsUUID(String uuid, Callback<Boolean> callback) {
        existsData("tcpexploitfixer_uuids",
                "uuid = '" + uuid + "'",
                callback);
    }

    public void addConnection(String uuid) {
        existsConnection(uuid, result -> {
            if(!result) {
                insertData("tcpexploitfixer_connections",
                        "uuid",
                        "'" + uuid + "'");
            }
        });


    }

    public void delConnection(String uuid) {
        deleteDataFromTable("tcpexploitfixer_connections",
                "uuid = '" + uuid + "'");
    }

    public void existsConnection(String uuid, Callback<Boolean> callback) {
        existsData("tcpexploitfixer_connections",
                "uuid = '" + uuid + "'",
                callback);
    }


    /* BungeeCord Part
    public void addUUID(String uuid) {
        existsUUID(uuid, result -> {
            if(!result) {
                insertData("tcpexploitfixer_uuids",
                        "uuid",
                        "'" + uuid + "'");
            }
        });

    }

    public void delUUID(String uuid) {
        deleteDataFromTable("tcpexploitfixer_uuids",
                "uuid = '" + uuid + "'");
    }

      public void resetAll() {
        resetTable("tcpexploitfixer_uuids");
        resetTable("tcpexploitfixer_connections");
    }
    */
}
